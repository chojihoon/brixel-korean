/**
 * OLED Korean Support with SSD1306/SH1106 Drivers
 */
//% weight=100 color=#2c3e50 icon="\uf108" block="OLED Korean"
//% groups=["OLED 0.96 SSD1306", "OLED 1.3 SH1106"]
namespace OLEDKorean {
    // 16x16 Korean Font (Chosung, Jungsung, Jongsung)
    // Converted to Hex Buffer for performance
    export const K_FONT = hex`
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000082C262321E0E00000000000000
        00000000000000000000000000000000
        00004262325E6E321E0E000000000000
        00000000000000000000000000000000
        000000FEFE8080808000000000000000
        00000000000000000000000000000000
        000000FEFE8282828200000000000000
        00000000000000000000000000000000
        0000FEFE82FEFE828200000000000000
        00000000000000000000000000000000
        00007A7A4A4A4A4E4E00000000000000
        00000000000000000000000000000000
        00007E7E4242427E7E00000000000000
        00000000000000000000000000000000
        00007E7E4848487E7E00000000000000
        00000000000000000000000000000000
        00007E5E487E5E487E7E000000000000
        00000000000000000000000000000000
        00004060301E1E306040000000000000
        00000000000000000000000000000000
        0040603E5E603E1E6040000000000000
        00000000000000000000000000000000
        0000003C7E42427E3C00000000000000
        00000000000000000000000000000000
        00004262321E1E326242000000000000
        00000000000000000000000000000000
        0042623E5E623E1E6242000000000000
        00000000000000000000000000000000
        00004464341E1E346444000000000000
        00000000000000000000000000000000
        0000008ACA6A3A1E0E00000000000000
        00000000000000000000000000000000
        00007E7E4A4A4A4A4000000000000000
        00000000000000000000000000000000
        0000427E7E42427E7E42000000000000
        00000000000000000000000000000000
        0000023A7E47477E3A02000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000002020202020202023E3E000000
        00000000000000000000000000000000
        0000000202023E3E0202023E3E000000
        00000000000000000000000000000000
        0000003E3E2020202020202020000000
        00000000000000000000000000000000
        0000003E3E2222222222222222000000
        00000000000000000000000000000000
        0000003E3E2222003E3E222222000000
        00000000000000000000000000000000
        0000003A3A2A2A2A2A2A2A2E2E000000
        00000000000000000000000000000000
        000000003E3E222222223E3E00000000
        00000000000000000000000000000000
        0000003E3E2828282828283E3E000000
        00000000000000000000000000000000
        0000003E3E28283E3E28283E3E000000
        00000000000000000000000000000000
        0000002030180C06060C183020000000
        00000000000000000000000000000000
        00000020301E1E30301E1E3020000000
        00000000000000000000000000000000
        000000001C3E222222223E1C00000000
        00000000000000000000000000000000
        00000022321A0E06060E1A3222000000
        00000000000000000000000000000000
        00000022321A2E361A0E0E3222000000
        00000000000000000000000000000000
        00000024341C0C06060C1C3424000000
        00000000000000000000000000000000
        0000000A0A0A0A0A0A0A0A3E3E000000
        00000000000000000000000000000000
        0000003E3E2A2A2A2A2A2A2A2A000000
        00000000000000000000000000000000
        00000022223E3E22223E3E2222000000
        00000000000000000000000000000000
        000000021A3E262727263E1A02000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000002020202020202023E3E000000
        00000000000000000000000000000000
        0000000202023E3E0202023E3E000000
        00000000000000000000000000000000
        0000003E3E2020202020202020000000
        00000000000000000000000000000000
        0000003E3E2222222222222222000000
        00000000000000000000000000000000
        0000003E3E2222003E3E222222000000
        00000000000000000000000000000000
        0000003A3A2A2A2A2A2A2A2E2E000000
        00000000000000000000000000000000
        000000003E3E222222223E3E00000000
        00000000000000000000000000000000
        0000003E3E2828282828283E3E000000
        00000000000000000000000000000000
        0000003E3E28283E3E28283E3E000000
        00000000000000000000000000000000
        0000002030180C06060C183020000000
        00000000000000000000000000000000
        00000020301E1E30301E1E3020000000
        00000000000000000000000000000000
        000000001C3E222222223E1C00000000
        00000000000000000000000000000000
        00000022321A0E06060E1A3222000000
        00000000000000000000000000000000
        00000022321A2E361A0E0E3222000000
        00000000000000000000000000000000
        00000024341C0C06060C1C3424000000
        00000000000000000000000000000000
        0000000A0A0A0A0A0A0A0A3E3E000000
        00000000000000000000000000000000
        0000003E3E2A2A2A2A2A2A2A2A000000
        00000000000000000000000000000000
        00000022223E3E22223E3E2222000000
        00000000000000000000000000000000
        000000021A3E262727263E1A02000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000002020202023E3E00000000000000
        00000000000000000000000000000000
        0002023E3E02023E3E00000000000000
        00000000000000000000000000000000
        00003E3E202020202020000000000000
        00000000000000000000000000000000
        00003E3E222222222222000000000000
        00000000000000000000000000000000
        00003E3E22223E3E2222000000000000
        00000000000000000000000000000000
        00003A3A2A2A2A2E2E00000000000000
        00000000000000000000000000000000
        00003E3E2222223E3E00000000000000
        00000000000000000000000000000000
        00003E3E2828283E3E00000000000000
        00000000000000000000000000000000
        00003E2E283E2E283E3E000000000000
        00000000000000000000000000000000
        00002030180E0E183020000000000000
        00000000000000000000000000000000
        000020301E2E301E0E30200000000000
        00000000000000000000000000000000
        0000001C3E22223E1C00000000000000
        00000000000000000000000000000000
        000022321A0E0E1A3222000000000000
        00000000000000000000000000000000
        0022321E2E321E0E3222000000000000
        00000000000000000000000000000000
        000024341C0E0E1C3424000000000000
        00000000000000000000000000000000
        00000A0A0A0A0A0A3E3E000000000000
        00000000000000000000000000000000
        00003E3E2A2A2A2A2A00000000000000
        00000000000000000000000000000000
        0000223E3E22223E3E22000000000000
        00000000000000000000000000000000
        0000021A3E27273E1A02000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000002020202023E3E00000000000000
        00000000000000000000000000000000
        0002023E3E02023E3E00000000000000
        00000000000000000000000000000000
        00003E3E202020202020000000000000
        00000000000000000000000000000000
        00003E3E222222222222000000000000
        00000000000000000000000000000000
        00003E3E22223E3E2222000000000000
        00000000000000000000000000000000
        00003A3A2A2A2A2E2E00000000000000
        00000000000000000000000000000000
        00003E3E2222223E3E00000000000000
        00000000000000000000000000000000
        00003E3E2828283E3E00000000000000
        00000000000000000000000000000000
        00003E2E283E2E283E3E000000000000
        00000000000000000000000000000000
        00002030180E0E183020000000000000
        00000000000000000000000000000000
        000020301E2E301E0E30200000000000
        00000000000000000000000000000000
        0000001C3E22223E1C00000000000000
        00000000000000000000000000000000
        000022321A0E0E1A3222000000000000
        00000000000000000000000000000000
        0022321E2E321E0E3222000000000000
        00000000000000000000000000000000
        000024341C0E0E1C3424000000000000
        00000000000000000000000000000000
        00000A0A0A0A0A0A3E3E000000000000
        00000000000000000000000000000000
        00003E3E2A2A2A2A2A00000000000000
        00000000000000000000000000000000
        0000223E3E22223E3E22000000000000
        00000000000000000000000000000000
        0000021A3E27273E1A02000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000082C262321E0E0000000000000000
        00000000000000000000000000000000
        004262325E6E321E0E00000000000000
        00000000000000000000000000000000
        0000FEFE808080808000000000000000
        00000000000000000000000000000000
        0000FEFE828282820000000000000000
        00000000000000000000000000000000
        0000FEFE82FEFE828200000000000000
        00000000000000000000000000000000
        00007A7A4A4A4E4E0000000000000000
        00000000000000000000000000000000
        00007E7E42427E7E0000000000000000
        00000000000000000000000000000000
        00007E7E48487E7E0000000000000000
        00000000000000000000000000000000
        007E5E487E5E487E0000000000000000
        00000000000000000000000000000000
        004060301E1E30604000000000000000
        00000000000000000000000000000000
        40603E5E603E1E604000000000000000
        00000000000000000000000000000000
        00003C7E42427E3C0000000000000000
        00000000000000000000000000000000
        004262321E1E32624200000000000000
        00000000000000000000000000000000
        42623E5E623E1E624000000000000000
        00000000000000000000000000000000
        004464341E1E34644400000000000000
        00000000000000000000000000000000
        00008ACA6A3A1E0E0000000000000000
        00000000000000000000000000000000
        00007E7E4A4A4A4A0000000000000000
        00000000000000000000000000000000
        00427E7E427E7E420000000000000000
        00000000000000000000000000000000
        00023A7E47477E3A0200000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000002020202020202023E3E000000
        00000000000000000000000000000000
        0000000202023E3E0202023E3E000000
        00000000000000000000000000000000
        0000003E3E2020202020202020000000
        00000000000000000000000000000000
        0000003E3E2222222222222222000000
        00000000000000000000000000000000
        0000003E3E2222003E3E222222000000
        00000000000000000000000000000000
        0000003A3A2A2A2A2A2A2A2E2E000000
        00000000000000000000000000000000
        000000003E3E222222223E3E00000000
        00000000000000000000000000000000
        0000003E3E2828282828283E3E000000
        00000000000000000000000000000000
        0000003E3E28283E3E28283E3E000000
        00000000000000000000000000000000
        0000002030180C06060C183020000000
        00000000000000000000000000000000
        00000020301E1E30301E1E3020000000
        00000000000000000000000000000000
        000000001C3E222222223E1C00000000
        00000000000000000000000000000000
        00000022321A0E06060E1A3222000000
        00000000000000000000000000000000
        00000022321A2E361A0E0E3222000000
        00000000000000000000000000000000
        00000024341C0C06060C1C3424000000
        00000000000000000000000000000000
        0000000A0A0A0A0A0A0A0A3E3E000000
        00000000000000000000000000000000
        0000003E3E2A2A2A2A2A2A2A2A000000
        00000000000000000000000000000000
        00000022223E3E22223E3E2222000000
        00000000000000000000000000000000
        000000021A3E262727263E1A02000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        0000020202023E3E0000000000000000
        00000000000000000000000000000000
        0002023E3E02023E3E00000000000000
        00000000000000000000000000000000
        00003E3E202020202000000000000000
        00000000000000000000000000000000
        00003E3E222222220000000000000000
        00000000000000000000000000000000
        00003E3E223E3E222200000000000000
        00000000000000000000000000000000
        003A3A2A2A2A2E2E0000000000000000
        00000000000000000000000000000000
        003E3E2222223E3E0000000000000000
        00000000000000000000000000000000
        003E3E2828283E3E0000000000000000
        00000000000000000000000000000000
        003E2E283E2E283E0000000000000000
        00000000000000000000000000000000
        002030180E0E18302000000000000000
        00000000000000000000000000000000
        0020301E2E301E0E3020000000000000
        00000000000000000000000000000000
        00001C3E22223E1C0000000000000000
        00000000000000000000000000000000
        0022321A0E0E1A322200000000000000
        00000000000000000000000000000000
        22321E2E321E0E322200000000000000
        00000000000000000000000000000000
        0024341C0E0E1C342400000000000000
        00000000000000000000000000000000
        000A0A0A0A0A3E3E0000000000000000
        00000000000000000000000000000000
        00003E3E2A2A2A2A0000000000000000
        00000000000000000000000000000000
        00223E3E223E3E220000000000000000
        00000000000000000000000000000000
        00021A3E27273E1A0200000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000000000000000000000000FEFE1010
        0000000000000000000000001F1F0000
        00000000000000000000FEFE20FEFE00
        000000000000000000000F0F001F1F00
        000000000000000000000000FEFE4848
        0000000000000000000000001F1F0000
        00000000000000000000FEFE90FEFE00
        000000000000000000000F0F001F1F00
        000000000000000000101010FEFE0000
        0000000000000000000000001F1F0000
        00000000000000101010FEFE00FEFE00
        000000000000000000000F0F001F1F00
        000000000000000000282828FEFE0000
        0000000000000000000000001F1F0000
        00000000000000282828FEFE00FEFE00
        000000000000000000000F0F001F1F00
        00000000000000808000000000000000
        00000404040404070704040404040000
        0000000000808000000000FEFE808000
        00000202020303020202001F1F000000
        00000000808000000000FEFE20FEFE00
        000202020303020202020F0F001F1F00
        000000000080800000000000FEFE0000
        0000020202030302020202021F1F0000
        00000000008080000080800000000000
        00000404040707040407070404040000
        00000000000000000000000000000000
        000001010101013F3F01010101010000
        000080808080808080808000FEFE0000
        00000000001F1F00000404043F3F0000
        00808080808080808000FEFE00FEFE00
        000000000F0F000404041F1F003F3F00
        000080808080808080808000FEFE0000
        00000000001F1F00000000003F3F0000
        00000000000000000000000000000000
        00000101013F3F01013F3F0101010000
        00000000000000000000000000000000
        00000404040404040404040404040400
        000000000000000000000000FEFE0000
        0000010101010101010101001F1F0000
        000000000000000000000000FEFE0000
        0000000000000000000000001F1F0000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000000000000000000000000FEFE1010
        0000000000000000000000001F1F0000
        00000000000000000000FEFE20FEFE00
        000000000000000000000F0F001F1F00
        000000000000000000000000FEFE4848
        0000000000000000000000001F1F0000
        00000000000000000000FEFE90FEFE00
        000000000000000000000F0F001F1F00
        000000000000000000101010FEFE0000
        0000000000000000000000001F1F0000
        00000000000000101010FEFE00FEFE00
        000000000000000000000F0F001F1F00
        000000000000000000282828FEFE0000
        0000000000000000000000001F1F0000
        00000000000000282828FEFE00FEFE00
        000000000000000000000F0F001F1F00
        00000000000000808000000000000000
        00000404040404070704040404040000
        0000000000808000000000FEFE808000
        00000202020303020202001F1F000000
        00000000808000000000FEFE20FEFE00
        000202020303020202020F0F001F1F00
        000000000080800000000000FEFE0000
        0000020202030302020202021F1F0000
        00000000008080000080800000000000
        00000404040707040407070404040000
        00000000000000000000000000000000
        000001010101013F3F01010101010000
        000080808080808080808000FEFE0000
        00000000001F1F00000404043F3F0000
        00808080808080808000FEFE00FEFE00
        000000000F0F000404041F1F003F3F00
        000080808080808080808000FEFE0000
        00000000001F1F00000000003F3F0000
        00000000000000000000000000000000
        00000101013F3F01013F3F0101010000
        00000000000000000000000000000000
        00000404040404040404040404040400
        000000000000000000000000FEFE0000
        0000010101010101010101001F1F0000
        000000000000000000000000FEFE0000
        0000000000000000000000001F1F0000
        00000000000000000000000000000000
        00000000000000000000000000000000
        0000000000000000000000FEFE101010
        000000000000000000001F1F00000000
        000000000000000000FEFE20FEFE0000
        0000000000000000000F0F001F1F0000
        0000000000000000000000FEFE484848
        000000000000000000001F1F00000000
        000000000000000000FEFE90FEFE0000
        0000000000000000000F0F001F1F0000
        0000000000000000101010FEFE000000
        00000000000000000000001F1F000000
        000000000000101010FEFE00FEFE0000
        0000000000000000000F0F001F1F0000
        0000000000000000282828FEFE000000
        00000000000000000000001F1F000000
        000000000000282828FEFE00FEFE0000
        0000000000000000000F0F001F1F0000
        000000000000808000000000FEFE8080
        0000020202030302020200001F1F0000
        00000000808000000000FEFE20FEFE00
        00000202030302020202000F0F1F1F00
        00000000008080000000FEFE00FEFE00
        000002020303020202020F0F001F1F00
        000000000080800000000000FEFE0000
        00000202020303020202000F0F000000
        0000000000808000808000FEFE808000
        00000202020303020303001F1F000000
        00000000000000000000000000000000
        00000101010101013F3F010101010000
        0000808080808080808000FEFE000000
        000000000F0F000404041F1F003F3F00
        00808080808080808000FEFE00FEFE00
        00000000000F0F04041F1F00003F3F00
        0000808080808080808000FEFE000000
        0000000000001F1F0000003F3F000000
        00000000000000000000000000000000
        000001013F3F01013F3F010101010000
        00000000000000000000000000000000
        00000404040404040404040404040000
        0000000000000000000000FEFE000000
        000001010101010101010F0F1F1F0000
        0000000000000000000000FEFE000000
        000000000000000000001F1F00000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        0000000000000000000000FEFE101010
        000000000000000000001F1F00000000
        000000000000000000FEFE20FEFE0000
        0000000000000000000F0F001F1F0000
        0000000000000000000000FEFE484848
        000000000000000000001F1F00000000
        000000000000000000FEFE90FEFE0000
        0000000000000000000F0F001F1F0000
        0000000000000000101010FEFE000000
        00000000000000000000001F1F000000
        000000000000101010FEFE00FEFE0000
        0000000000000000000F0F001F1F0000
        0000000000000000282828FEFE000000
        00000000000000000000001F1F000000
        000000000000282828FEFE00FEFE0000
        0000000000000000000F0F001F1F0000
        000000000000808000000000FEFE8080
        0000020202030302020200001F1F0000
        00000000808000000000FEFE20FEFE00
        00000202030302020202000F0F1F1F00
        00000000008080000000FEFE00FEFE00
        000002020303020202020F0F001F1F00
        000000000080800000000000FEFE0000
        00000202020303020202000F0F000000
        0000000000808000808000FEFE808000
        00000202020303020303001F1F000000
        00000000000000000000000000000000
        00000101010101013F3F010101010000
        0000808080808080808000FEFE000000
        000000000F0F000404041F1F003F3F00
        00808080808080808000FEFE00FEFE00
        00000000000F0F04041F1F00003F3F00
        0000808080808080808000FEFE000000
        0000000000001F1F0000003F3F000000
        00000000000000000000000000000000
        000001013F3F01013F3F010101010000
        00000000000000000000000000000000
        00000404040404040404040404040000
        0000000000000000000000FEFE000000
        000001010101010101010F0F1F1F0000
        0000000000000000000000FEFE000000
        000000000000000000001F1F00000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000000000000000000001010FEFE1010
        00000000000000000000001F1F000000
        0000000000000000FEFE2000FEFE0000
        00000000000000000F0F00001F1F0000
        000000000000000000004848FEFE4848
        00000000000000000000001F1F000000
        0000000000000000FEFE9000FEFE0000
        00000000000000000F0F00001F1F0000
        00000000000000001010FEFE10100000
        000000000000000000001F1F00000000
        0000000000101010FEFE0000FEFE0000
        000000000000000F0F000000001F1F00
        00000000000000002828FEFE28280000
        000000000000000000001F1F00000000
        0000000000282828FEFE0000FEFE0000
        00000000000000000F0F00001F1F0000
        0000000000008080000000FEFE808000
        00000202020303020202001F1F000000
        000000008080000000FEFE2000FEFE00
        0000020203030202020F0F00001F1F00
        000000000080800000FEFE0000FEFE00
        0000020202030302020F0F00001F1F00
        0000000000808000000000FEFE000000
        00000202020303020202020F0F000000
        000000000080800080800000FEFE8080
        0000020202030302030300001F1F0000
        00000000000000000000000000000000
        0000010101010101013F3F0101010000
        00008080808080808000FEFE00000000
        0000000000000F0F000404003F3F0000
        80808080808080800000FEFE0000FEFE
        000000000F0F00000404001F1F3F3F00
        00008080808080808000FEFE00000000
        00000000000000001F1F00003F3F0000
        00000000000000000000000000000000
        0000010101013F3F013F3F0101010000
        00000000000000000000000000000000
        00000404040404040404040404040000
        00000000000000000000FEFE00000000
        0000010101010101010F0F001F1F0000
        00000000000000000000FEFE00000000
        0000000000000000001F1F0000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000000000000000000001010FEFE1010
        00000000000000000000001F1F000000
        0000000000000000FEFE2000FEFE0000
        00000000000000000F0F00001F1F0000
        000000000000000000004848FEFE4848
        00000000000000000000001F1F000000
        0000000000000000FEFE9000FEFE0000
        00000000000000000F0F00001F1F0000
        00000000000000001010FEFE10100000
        000000000000000000001F1F00000000
        0000000000101010FEFE0000FEFE0000
        000000000000000F0F000000001F1F00
        00000000000000002828FEFE28280000
        000000000000000000001F1F00000000
        0000000000282828FEFE0000FEFE0000
        00000000000000000F0F00001F1F0000
        0000000000008080000000FEFE808000
        00000202020303020202001F1F000000
        000000008080000000FEFE2000FEFE00
        0000020203030202020F0F00001F1F00
        000000000080800000FEFE0000FEFE00
        0000020202030302020F0F00001F1F00
        0000000000808000000000FEFE000000
        00000202020303020202020F0F000000
        000000000080800080800000FEFE8080
        0000020202030302030300001F1F0000
        00000000000000000000000000000000
        0000010101010101013F3F0101010000
        00008080808080808000FEFE00000000
        0000000000000F0F000404003F3F0000
        80808080808080800000FEFE0000FEFE
        000000000F0F00000404001F1F3F3F00
        00008080808080808000FEFE00000000
        00000000000000001F1F00003F3F0000
        00000000000000000000000000000000
        0000010101013F3F013F3F0101010000
        00000000000000000000000000000000
        00000404040404040404040404040000
        00000000000000000000FEFE00000000
        0000010101010101010F0F001F1F0000
        00000000000000000000FEFE00000000
        0000000000000000001F1F0000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000000000000000000007C7C54545454
        00000000000000000000000000000000
        0000000000000000007C7C54545C5C00
        00000000000000000000000000000000
        0000000000000000007C7C54447C7C44
        00000000000000000000000000000000
        000000000000007474545C5C54000000
        00000000000000000000000000000000
        000000000000007474545C5C447C7C44
        00000000000000000000000000000000
        0000000000007474545C5C287C285C28
        00000000000000000000000000000000
        0000000000007C7C4444447C7C000000
        00000000000000000000000000000000
        0000000000007C7C5050507C7C000000
        00000000000000000000000000000000
        0000000000007C507C7C40603C3C6040
        00000000000000000000000000000000
        000000000000406030180C0C18306040
        00000000000000000000000000000000
        00000000004060305C5C30180C306040
        00000000000000000000000000000000
        00000000000000387C444444447C3800
        00000000000000000000000000000000
        00000000000048683818181818386848
        00000000000000000000000000000000
        00000000486838180C5C0C1818386848
        00000000000000000000000000000000
        0000000000001414141414147C7C0000
        00000000000000000000000000000000
        0000000000007C7C5454545454540000
        00000000000000000000000000000000
        000000000000447C7C44447C7C440000
        00000000000000000000000000000000
        00000000000028785C5C5C5C78280000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        000000000000000000007C7C54545454
        00000000000000000000000000000000
        0000000000000000007C7C54545C5C00
        00000000000000000000000000000000
        0000000000000000007C7C54447C7C44
        00000000000000000000000000000000
        000000000000007474545C5C54000000
        00000000000000000000000000000000
        000000000000007474545C5C447C7C44
        00000000000000000000000000000000
        0000000000007474545C5C287C285C28
        00000000000000000000000000000000
        0000000000007C7C4444447C7C000000
        00000000000000000000000000000000
        0000000000007C7C5050507C7C000000
        00000000000000000000000000000000
        0000000000007C507C7C40603C3C6040
        00000000000000000000000000000000
        000000000000406030180C0C18306040
        00000000000000000000000000000000
        00000000004060305C5C30180C306040
        00000000000000000000000000000000
        00000000000000387C444444447C3800
        00000000000000000000000000000000
        00000000000048683818181818386848
        00000000000000000000000000000000
        00000000486838180C5C0C1818386848
        00000000000000000000000000000000
        0000000000001414141414147C7C0000
        00000000000000000000000000000000
        0000000000007C7C5454545454540000
        00000000000000000000000000000000
        000000000000447C7C44447C7C440000
        00000000000000000000000000000000
        00000000000028785C5C5C5C78280000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000007C7C545454
        00000000000000000000000000000000
        000000000000000000007C7C54545C5C
        00000000000000000000000000000000
        00000000000000000000547C7C447C44
        00000000000000000000000000000000
        0000000000000000007474545C5C5400
        00000000000000000000000000000000
        00000000000000007474545C5C447C44
        00000000000000000000000000000000
        000000000000007474545C5C287C5C28
        00000000000000000000000000000000
        00000000000000007C7C4444447C7C00
        00000000000000000000000000000000
        00000000000000007C7C5050507C7C00
        00000000000000000000000000000000
        00000000000000007C507C40603C6040
        00000000000000000000000000000000
        0000000000000000406030180C183040
        00000000000000000000000000000000
        000000000000004060305C30180C3040
        00000000000000000000000000000000
        0000000000000000387C4444447C3800
        00000000000000000000000000000000
        0000000000000000486838181838684800
        0000000000000000000000000000000000
        0000000000004868380C5C0C18386848
        00000000000000000000000000000000
        000000000000000014141414147C7C00
        00000000000000000000000000000000
        000000000000007C7C54545454545400
        00000000000000000000000000000000
        0000000000000000447C7C447C7C4400
        00000000000000000000000000000000
        000000000000000028785C5C5C782800
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000000000000000
        00000000000000000000007C7C545454
        00000000000000000000000000000000
        000000000000000000007C7C54545C5C
        00000000000000000000000000000000
        00000000000000000000547C7C447C44
        00000000000000000000000000000000
        0000000000000000007474545C5C5400
        00000000000000000000000000000000
        00000000000000007474545C5C447C44
        00000000000000000000000000000000
        000000000000007474545C5C287C5C28
        00000000000000000000000000000000
        00000000000000007C7C4444447C7C00
        00000000000000000000000000000000
        00000000000000007C7C5050507C7C00
        00000000000000000000000000000000
        00000000000000007C507C40603C6040
        00000000000000000000000000000000
        0000000000000000406030180C183040
        00000000000000000000000000000000
        000000000000004060305C30180C3040
        00000000000000000000000000000000
        0000000000000000387C4444447C3800
        00000000000000000000000000000000
        0000000000000000486838181838684800
        0000000000000000000000000000000000
        0000000000004868380C5C0C18386848
        00000000000000000000000000000000
        000000000000000014141414147C7C00
        00000000000000000000000000000000
        000000000000007C7C54545454545400
        00000000000000000000000000000000
        0000000000000000447C7C447C7C4400
        00000000000000000000000000000000
        000000000000000028785C5C5C782800`;

    // 8x16 English Font
    export const E_FONT = hex`
        00000000000000000000000000000000
        F8041404041404F80708090B0B090807
        F8FC6C7C7C6CFCF8070F0F0C0C0F0F07
        00F0F8F8F0F8F8F00000010307030100
        0040E0F0F8F0E0400000000103010000
        E0E0F81C1CF8E0E00000040707040000
        60F0F8FCFCF8F0600000040707040000
        000060F0F06000000000000000000000
        00FF1F0F0F0F1FFF00FFFFFEFEFEFFFF
        0000E0101010E0000000000101010000
        00FF1FEFEFEF1FFF00FFFFFEFEFEFFFF
        000090487C4890000003040808080403
        0030488484844830000202020F020202
        000000FC0408700000060F0700000000
        000000FC141414FC000C1E0F00060F07
        5050E0BCBCE050500101000707000101
        0000FCF8F0E040000000070301000000
        000040E0F0F8FC000000000001030700
        001018FCFC1810000001030707030100
        0000FCFC0000FCFC0000040400000404
        387C44FCFC04FCFC0000000707000707
        00C4EE3A1232E6C40008191312171D08
        0000000000000000000E0E0E0E0E0E00
        001018FCFC18100008090B0F0F0B0908
        001018FCFC1810000000000707000000
        000000FCFC0000000001030707030100
        0040404050F0E0400000000001010000
        0040E0F0504040400000000101000000
        F8000000000000000302020202020202
        40E050404050E0400000010000010000
        000000C0F0C000000004070707070704
        001070F0F0F070100000000107010000
        00000000000000000000000000000000
        000038FCFC3800000000000D0D000000
        000E1E00001E0E000000000000000000
        20F8F820F8F82000020F0F020F0F0200
        387C444747CC9800060C0838380F0700
        30300080C06030000C060301000C0C00
        80D87CE4BCD84000070F0808070F0800
        00101E0E000000000000000000000000
        0000F0F80C040000000003070C080000
        0000040CF8F000000000080C07030000
        80A0E0C0C0E0A0800002030101030200
        008080E0E08080000000000303000000
        00000000000000000000101E0E000000
        80808080808080000000000000000000
        00000000000000000000000C0C000000
        00000080C06030000C06030100000000
        F0F80CC40CF8F00003070C080C070300
        001018FCFC0000000008080F0F080800
        080C84C4643C18000E0F0908080C0C00
        080C444444FCB800040C0808080F0700
        C0E0B098FCFC8000000000080F0F0800
        7C7C444444C48400040C0808080F0700
        F0F84C4444C08000070F0808080F0700
        0C0C0484C47C3C0000000F0F00000000
        B8FC444444FCB800070F0808080F0700
        387C444444FCF800000808080C070300
        00000030300000000000000606000000
        00000030300000000000080E06000000
        0080C0603018080000000103060C0800
        00202020202020000001010101010100
        0008183060C0800000080C0603010000
        181C04C4E43C18000000000D0D000000
        F0F808C8C8F8F000070F080B0B0B0100
        E0F0988C98F0E0000F0F0000000F0F00
        04FCFC4444FCB800080F0F08080F0700
        F0F80C04040C180003070C08080C0600
        04FCFC040CF8F000080F0F080C070300
        04FCFC44E40C1C00080F0F08080C0E00
        04FCFC44E40C1C00080F0F0800000000
        F0F80C84848C980003070C0808070F00
        FCFC404040FCFC000F0F0000000F0F00
        000004FCFC0400000000080F0F080000
        00000004FCFC0400070F08080F070000
        04FCFCC0E03C1C00080F0F00010F0E00
        04FCFC0400000000080F0F08080C0E00
        FCFC387038FCFC000F0F0000000F0F00
        FCFC3870E0FCFC000F0F0000000F0F00
        F8FC040404FCF800070F0808080F0700
        04FCFC44447C3800080F0F0800000000
        F8FC040404FCF800070F080E3C3F2700
        04FCFC44C4FC3800080F0F00000F0F00
        183C6444C49C1800060E0808080F0700
        001C0CFCFC0C1C000000080F0F080000
        FCFC000000FCFC00070F0808080F0700
        FCFC000000FCFC000103060C06030100
        FCFC00C000FCFC00070F0E030E0F0700
        0C3CF0E0F03C0C000C0F0301030F0C00
        003C7CC0C07C3C000000080F0F080000
        1C0C84C4643C1C000E0F0908080C0E00
        0000FCFC0404000000000F0F08080000
        3870E0C0800000000000000103070E00
        00000404FCFC0000000008080F0F0000
        080C0603060C08000000000000000000
        00000000000000002020202020202020
        00000307040000000000000000000000
        00A0A0A0E0C00000070F0808070F0800
        04FCFC2060C08000000F0F08080F0700
        C0E0202020604000070F0808080C0400
        80C06024FCFC0000070F0808070F0800
        C0E0A0A0A0E0C000070F0808080C0400
        40F8FC440C180000080F0F0800000000
        C0E02020C0E02000276F48487F3F0000
        04FCFC4020E0C000080F0F00000F0F00
        000020ECEC0000000000080F0F080000
        0000000020ECEC0000307040407F3F00
        04FCFC80C0602000080F0F01030E0C00
        000004FCFC0000000000080F0F080000
        E0E060C060E0C0000F0F0007000F0F00
        20E0C02020E0C000000F0F00000F0F00
        C0E0202020E0C000070F0808080F0700
        20E0C02020E0C000407F7F48080F0700
        C0E02020C0E02000070F08487F7F4000
        20E0C06020E0C000080F0F0800000000
        40E0A02020604000040C09090B0E0400
        2020F8FC202000000000070F080C0400
        E0E00000E0E00000070F0808070F0800
        00E0E00000E0E0000003070C0C070300
        E0E0008000E0E000070F0C070C0F0700
        2060C080C0602000080C0703070C0800
        E0E0000000E0E000474F4848683F1F00
        606020A0E06020000C0E0B09080C0C00
        004040F8BC040400000000070F080800
        000000BCBC0000000000000F0F000000
        000404BCF84040000008080F07000000
        80C040C080C040000000000000000000
        00000609060000000000000000000000`;

    // 32x32 Big Numbers (0-10)
    export const BIG_NUMS: Buffer[] = [
        // 0
        hex`
            0000000080C0E8DCBE3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3EBEDCE8C080000000
            000000001F3F7F3F1F00000000000000
            00000000000000001F3F7F3F1F000000
            00000000FCFEFFFEFC00000000000000
            0000000000000000FCFEFFFEFC000000
            0000000000010B1D3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1D0B0100000000`,
        // 1
        hex`
            00000000000000000000000000000000
            0000000000000000F0F8FCF8F0000000
            00000000000000000000000000000000
            00000000000000001F3F7F3F1F000000
            00000000000000000000000000000000
            0000000000000000FCFEFFFEFC000000
            00000000000000000000000000000000
            0000000000000000070F1F0F07000000`,
        // 2
        hex`
            000000000000081C3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3EBEDCE8C080000000
            0000000000000080C0E0E0E0E0E0E0E0
            E0E0E0E0E0E0E0E0DFBF7F3F1F000000
            00000000FCFEFFFEFD03030303030303
            03030303030303030100000000000000
            0000000000010B1D3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1C080000000000`,
        // 3
        hex`
            000000000000081C3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3EBEDCE8C080000000
            0000000000000080C0E0E0E0E0E0E0E0
            E0E0E0E0E0E0E0E0DFBF7F3F1F000000
            00000000000000000103030303030303
            0303030303030303FDFEFFFEFC000000
            000000000000081C3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1D0B0100000000`,
        // 4
        hex`
            0000000080C0E8DCBE3E3E3E3E3E3E3E
            3E3E3E3E3E000000000000000000000000
            000000001F3F7F3F1F00000000000000
            00000000000000001F3F7F3F1F000000
            00000000FCFEFFFEFD03030303030303
            0303030303030303FDFEFFFEFC000000
            00000000000000000000000000000000
            0000000000000000070F1F0F07000000`,
        // 5
        hex`
            0000000080C0E8DCBE3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1C080000000000
            000000001F3F7FBFDFDFDFDFDFDFDFDF
            DFDFDFDFDFDFDFDFC080000000000000
            00000000000000000103030303030303
            0303030303030303FDFEFFFEFC000000
            000000000000081C3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1D0B0100000000`,
        // 6
        hex`
            0000000080C0E8DCBE3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1C080000000000
            000000001F3F7FBFDFDFDFDFDFDFDFDF
            DFDFDFDFDFDFDFDFC080000000000000
            00000000FCFEFFFEFD03030303030303
            0303030303030303FDFEFFFEFC000000
            0000000000010B1D3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1D0B0100000000`,
        // 7
        hex`
            000000000000081C3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3EBEDCE8C080000000
            00000000000000000000000000000000
            00000000000000001F3F7F3F1F000000
            00000000000000000000000000000000
            0000000000000000FCFEFFFEFC000000
            00000000000000000000000000000000
            0000000000000000070F1F0F07000000`,
        // 8
        hex`
            0000000080C0E8DCBE3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3EBEDCE8C080000000
            000000001F3F7FBFDFDFDFDFDFDFDFDF
            DFDFDFDFDFDFDFDFC1837F3F1F000000
            00000000FCFEFFFEFD03030303030303
            0303030303030303FDFEFFFEFC000000
            0000000000010B1D3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1D0B0100000000`,
        // 9
        hex`
            0000000080C0E8DCBE3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3EBEDCE8C080000000
            000000001F3F7FBFDFDFDFDFDFDFDFDF
            DFDFDFDFDFDFDFDFC1837F3F1F000000
            00000000000000000103030303030303
            0303030303030303FDFEFFFEFC000000
            000000000000081C3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1D0B0100000000`,
        // 10
        hex`
            00000000000000000000000000000000
            00000000000000000000000000000000
            00000000000000000000000000000000
            00000000000000000000000000000000
            00000000FCFEFFFEFD03030303030303
            0303030303030303FDFEFFFEFC000000
            0000000000010B1D3E3E3E3E3E3E3E3E
            3E3E3E3E3E3E3E3E3E1D0B0100000000`
    ];

    // OLED I2C Address
    let OLED_ADDR = 0x3c;

    // Display buffer - 지연 초기화 (Lazy initialization)
    let oled_buffer: Buffer = null;

    // Initialization flag
    let _isInited = false;
    // Display type: 0=SSD1306(0.96), 1=SH1106(1.3)
    let _displayType = 0;

    // 버퍼 초기화 함수
    function ensureBuffer(): void {
        if (!oled_buffer) {
            oled_buffer = pins.createBuffer(1025);
        }
    }

    /**
     * OLED 초기화
     * @param type 화면 종류 (SSD1306 또는 SH1106)
     */
    //% block="OLED 0.96 초기화"
    //% group="OLED 0.96 SSD1306"
    //% weight=100
    export function init(type: number = 0): void {
        ensureBuffer();
        _displayType = type;
        if (type == 0) {
            // SSD1306 Init Sequence
            writeCmd(0xAE); // Display Off
            writeCmd(0xD5); // Set Display Clock Divide Ratio/Oscillator Frequency
            writeCmd(0x80); // Suggested ratio
            writeCmd(0xA8); // Set Multiplex Ratio
            writeCmd(0x3F); // 1/64 duty   
            writeCmd(0xD3); // Set Display Offset
            writeCmd(0x00); // 0 offset
            writeCmd(0x40); // Set Start Line
            writeCmd(0x8D); // Charge Pump
            writeCmd(0x14); // Enable Charge Pump
            writeCmd(0x20); // Memory Addressing Mode
            writeCmd(0x00); // Horizontal Addressing Mode
            writeCmd(0xA1); // Segment Remap
            writeCmd(0xC8); // COM Output Scan Direction
            writeCmd(0xDA); // Set COM Pins Hardware Configuration
            writeCmd(0x12);
            writeCmd(0x81); // Set Contrast Control
            writeCmd(0xCF);
            writeCmd(0xD9); // Set Pre-Charge Period
            writeCmd(0xF1);
            writeCmd(0xDB); // Set VCOMH Deselect Level
            writeCmd(0x40);
            writeCmd(0xA4); // Entire Display Resume
            writeCmd(0xA6); // Set Normal Display
            writeCmd(0xAF); // Display On
        } else {
            // SH1106 Init Sequence
            writeCmd(0xAE); // Display Off
            writeCmd(0xD5); // Set Display Clock Divide Ratio/Oscillator Frequency
            writeCmd(0x80);
            writeCmd(0xA8); // Set Multiplex Ratio
            writeCmd(0x3F);
            writeCmd(0xD3); // Set Display Offset
            writeCmd(0x00);
            writeCmd(0x40); // Set Start Line
            writeCmd(0xA1); // Segment Remap
            writeCmd(0xC8); // COM Output Scan Direction
            writeCmd(0xDA); // COM Pins Hardware Configuration
            writeCmd(0x12);
            writeCmd(0x81); // Contrast Control
            writeCmd(0xFF);
            writeCmd(0xD9); // Pre-Charge Period
            writeCmd(0x11); // 
            writeCmd(0xDB); // VCOMH Deselect Level
            writeCmd(0x40);
            writeCmd(0x30); // Pump voltage value
            writeCmd(0xAD); // DC-DC control mode
            writeCmd(0x8B); // DC-DC ON
            writeCmd(0xA4); // Entire Display Resume
            writeCmd(0xA6); // Set Normal Display
            writeCmd(0xAF); // Display On
        }
        _isInited = true;
        clear();
    }

    /**
     * 화면 지우기
     */
    //% block="OLED 0.96 화면 지우기"
    //% group="OLED 0.96 SSD1306"
    //% weight=99
    export function clear(): void {
        ensureBuffer();
        oled_buffer.fill(0);
        // buffer[0] is control byte 0x40 for data
        oled_buffer[0] = 0x40;
        updateDisplay();
    }

    /**
     * 문자열 출력 (영문/숫자만)
     * @param text 출력할 텍스트
     * @param x X 좌표
     * @param y Y 좌표
     */
    //% block="OLED 0.96 영문 출력 %text x: %x y: %y"
    //% group="OLED 0.96 SSD1306"
    //% weight=90
    export function showString(text: string, x: number, y: number): void {
        if (!_isInited) init(_displayType);
        ensureBuffer();

        let cursorX = x;
        for (let i = 0; i < text.length; i++) {
            let c = text.charCodeAt(i);
            if (c >= 32 && c < 128) {
                drawAscii(c, cursorX, y);
                cursorX += 8;
            }
        }
        updateDisplay();
    }

    /**
     * 한글 문자열 출력 (Buffer 사용)
     * @param text 출력할 한글 텍스트
     * @param x X 좌표
     * @param y Y 좌표
     */
    //% block="OLED 0.96 한글 출력 %text x: %x y: %y"
    //% group="OLED 0.96 SSD1306"
    //% weight=89
    export function showKorean(text: string, x: number, y: number): void {
        if (!_isInited) init(_displayType);
        ensureBuffer();

        // 문자열을 Buffer로 변환 (UTF-8)
        let buf = Buffer.fromUTF8(text);
        let cursorX = x;
        let i = 0;

        while (i < buf.length) {
            let c1 = buf[i];

            if (c1 < 0x80) {
                // ASCII (1 byte)
                if (c1 >= 32) {
                    drawAscii(c1, cursorX, y);
                    cursorX += 8;
                }
                i++;
            } else if ((c1 & 0xE0) == 0xC0) {
                // 2-byte UTF-8 sequence
                i += 2;
            } else if ((c1 & 0xF0) == 0xE0) {
                // 3-byte UTF-8 sequence (Korean)
                let c2 = buf[i + 1];
                let c3 = buf[i + 2];
                let charCode = ((c1 & 0x0F) << 12) | ((c2 & 0x3F) << 6) | (c3 & 0x3F);

                if (charCode >= 0xAC00 && charCode <= 0xD7A3) {
                    // Korean syllable (가-힣)
                    drawKorean(charCode, cursorX, y);
                    cursorX += 16;
                }
                i += 3;
            } else {
                i++;
            }
        }
        updateDisplay();
    }

    /**
     * 디버그: 문자열의 길이와 첫번째 charCodeAt 값
     * @param text 테스트할 문자열
     */
    //% block="OLED 0.96 디버그 %text"
    //% group="OLED 0.96 SSD1306"
    //% weight=85
    export function debugCharCode(text: string): void {
        if (!_isInited) init(_displayType);
        ensureBuffer();
        oled_buffer.fill(0);
        oled_buffer[0] = 0x40;

        // 문자열 길이 표시 (첫 줄)
        let lenStr = "L:" + text.length;
        let xPos = 0;
        for (let j = 0; j < lenStr.length; j++) {
            drawAscii(lenStr.charCodeAt(j), xPos, 0);
            xPos += 8;
        }

        // 첫번째 문자의 charCodeAt 표시 (둘째 줄)
        if (text.length > 0) {
            let code = text.charCodeAt(0);
            let codeStr = "C:" + code;
            xPos = 0;
            for (let j = 0; j < codeStr.length; j++) {
                drawAscii(codeStr.charCodeAt(j), xPos, 16);
                xPos += 8;
            }
        }

        updateDisplay();
    }

    /**
     * 디버그: 유니코드 직접 테스트
     * @param code 유니코드 값 (예: 44032 = '가')
     */
    //% block="OLED 0.96 유니코드 테스트 %code x: %x y: %y"
    //% group="OLED 0.96 SSD1306"
    //% weight=84
    export function testUnicode(code: number, x: number, y: number): void {
        if (!_isInited) init(_displayType);
        ensureBuffer();
        if (code >= 0xAC00 && code <= 0xD7A3) {
            drawKorean(code, x, y);
        }
        updateDisplay();
    }

    /**
     * 큰 숫자 출력
     * @param num 출력할 숫자 (0-9)
     * @param x X 좌표
     * @param y Y 좌표
     */
    //% block="OLED 0.96 큰 숫자 출력 %num x: %x y: %y"
    //% group="OLED 0.96 SSD1306"
    //% weight=80
    export function showBigNumber(num: number, x: number, y: number): void {
        if (!_isInited) init(_displayType);
        ensureBuffer();
        if (num < 0 || num > 10) return;

        let data = BIG_NUMS[num];

        for (let p = 0; p < 4; p++) { // 4 pages high
            let pageY = Math.floor(y / 8) + p;
            if (pageY >= 8) break;

            for (let col = 0; col < 32; col++) {
                let bufferX = x + col;
                if (bufferX >= 128) break;

                let dataIdx = (p * 32) + col;
                let val = data[dataIdx];

                // Write to buffer
                let bufIdx = (pageY * 128) + bufferX + 1;
                oled_buffer[bufIdx] = val;
            }
        }
        updateDisplay();
    }

    // --- SH1106 Wrappers with different group ---

    /**
     * OLED 1.3 초기화
     */
    //% block="OLED 1.3 초기화"
    //% group="OLED 1.3 SH1106"
    //% weight=100
    export function initSH1106(): void {
        init(1);
    }

    /**
     * OLED 1.3 화면 지우기
     */
    //% block="OLED 1.3 화면 지우기"
    //% group="OLED 1.3 SH1106"
    //% weight=99
    export function clearSH1106(): void {
        clear();
    }

    /**
     * OLED 1.3 문자열 출력
     */
    //% block="OLED 1.3 문자열 출력 %text x: %x y: %y"
    //% group="OLED 1.3 SH1106"
    //% weight=90
    export function showStringSH1106(text: string, x: number, y: number): void {
        showString(text, x, y);
    }

    /**
     * OLED 1.3 큰 숫자 출력
     */
    //% block="OLED 1.3 큰 숫자 출력 %num x: %x y: %y"
    //% group="OLED 1.3 SH1106"
    //% weight=80
    export function showBigNumberSH1106(num: number, x: number, y: number): void {
        showBigNumber(num, x, y);
    }

    // --- Private Helper Functions ---

    function writeCmd(cmd: number) {
        let buf = pins.createBuffer(2);
        buf[0] = 0x00; // Control byte: command
        buf[1] = cmd;
        pins.i2cWriteBuffer(OLED_ADDR, buf);
    }

    function updateDisplay() {
        ensureBuffer();
        if (_displayType == 0) {
            writeCmd(0x21); writeCmd(0x00); writeCmd(0x7F); // Column address
            writeCmd(0x22); writeCmd(0x00); writeCmd(0x07); // Page address

            for (let i = 0; i < 8; i++) {
                let pageBuf = pins.createBuffer(129);
                pageBuf[0] = 0x40;
                for (let j = 0; j < 128; j++) {
                    pageBuf[1 + j] = oled_buffer[1 + (i * 128) + j];
                }
                if (_displayType == 0) {
                    pins.i2cWriteBuffer(OLED_ADDR, pageBuf);
                }
            }
        } else {
            // SH1106: Only supports Page Addressing Mode
            for (let i = 0; i < 8; i++) {
                writeCmd(0xB0 + i); // Set Page Address
                writeCmd(0x00); // Set Lower Column Address
                writeCmd(0x10); // Set Higher Column Address

                let pageBuf = pins.createBuffer(129);
                pageBuf[0] = 0x40;

                for (let j = 0; j < 128; j++) {
                    pageBuf[1 + j] = oled_buffer[1 + (i * 128) + j];
                }
                pins.i2cWriteBuffer(OLED_ADDR, pageBuf);
            }
        }
    }

    // Hangul Composition Constants (from original hmgothic)
    // cho1: 받침 없는 경우의 초성 타입 (인덱스 = 중성 1-21)
    const cho1 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3, 3, 1, 2, 4, 4, 4, 2, 1, 3, 0];
    // cho2: 받침 있는 경우의 초성 타입 (인덱스 = 중성 1-21)
    const cho2 = [0, 5, 5, 5, 5, 5, 5, 5, 5, 6, 7, 7, 7, 6, 6, 7, 7, 7, 6, 6, 7, 5];
    // jong: 종성 타입 (인덱스 = 중성 1-21)
    const jongTypeTable = [0, 0, 2, 0, 2, 1, 2, 1, 2, 3, 0, 2, 1, 3, 3, 1, 2, 1, 3, 3, 1, 1];

    function drawAscii(charCode: number, x: number, y: number) {
        ensureBuffer();
        if (charCode < 32 || charCode > 127) return;

        let idx = charCode * 16;  // E_FONT는 ASCII 0부터 시작
        let pageY = Math.floor(y / 8);
        
        // Top half
        if (pageY < 8) {
            for (let col = 0; col < 8; col++) {
                if (x + col < 128) {
                    let val = E_FONT[idx + col];
                    let bufIdx = 1 + (pageY * 128) + (x + col);
                    oled_buffer[bufIdx] |= val;
                }
            }
        }
        // Bottom half
        pageY++;
        if (pageY < 8) {
            for (let col = 0; col < 8; col++) {
                if (x + col < 128) {
                    let val = E_FONT[idx + 8 + col];
                    let bufIdx = 1 + (pageY * 128) + (x + col);
                    oled_buffer[bufIdx] |= val;
                }
            }
        }
    }

    function drawKorean(charCode: number, x: number, y: number) {
        ensureBuffer();
        let code = charCode - 0xAC00;
        if (code < 0 || code > 11171) return;

        // 종성, 중성, 초성 분리 (원본 C 코드와 동일한 로직)
        let jong = code % 28;           // 종성 0-27 (0은 없음)
        code = Math.floor(code / 28);
        let cho = Math.floor(code / 21) + 1;  // 초성 1-19
        let jung = (code % 21) + 1;           // 중성 1-21

        // 초성 타입 및 중성 타입 계산
        let choType = 0;
        let jungType = 0;
        let jongType = 0;

        if (jong == 0) {
            // 받침 없는 경우
            choType = cho1[jung];
            if (cho == 1) jungType = 0;  // 초성 ㄱ
            else jungType = 1;
        } else {
            // 받침 있는 경우
            choType = cho2[jung];
            if (cho == 1) jungType = 2;  // 초성 ㄱ
            else jungType = 3;
            jongType = jongTypeTable[jung];
        }

        // 폰트 인덱스 계산
        let final_cho = choType * 20 + cho;
        let final_jung = 160 + jungType * 22 + jung;
        let final_jong = 0;
        if (jong != 0) {
            final_jong = 248 + jongType * 28 + jong;
        }

        // Safety bounds
        if (final_cho >= 360) final_cho = 0;
        if (final_jung >= 360) final_jung = 0;
        if (final_jong >= 360) final_jong = 0;

        drawCharFromIndex(final_cho, x, y);
        drawCharFromIndex(final_jung, x, y);
        if (jong != 0) drawCharFromIndex(final_jong, x, y);
    }

    function drawCharFromIndex(idx: number, x: number, y: number) {
        ensureBuffer();
        let offset = idx * 32;

        // Top Half
        let pageY = Math.floor(y / 8);
        if (pageY < 8) {
            for (let col = 0; col < 16; col++) {
                if (x + col < 128) {
                    let val = K_FONT[offset + col];
                    // OR logic to overlay
                    let bufIdx = 1 + (pageY * 128) + (x + col);
                    oled_buffer[bufIdx] |= val;
                }
            }
        }
        // Bottom Half
        pageY++;
        if (pageY < 8) {
            for (let col = 0; col < 16; col++) {
                if (x + col < 128) {
                    let val = K_FONT[offset + 16 + col];
                    let bufIdx = 1 + (pageY * 128) + (x + col);
                    oled_buffer[bufIdx] |= val;
                }
            }
        }
    }
}
